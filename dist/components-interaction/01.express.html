<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Розроблення веб-сервера за допомогою express.js | Розподілені інформаційні системи</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/docs/faviconCustom.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <meta name="description" content="Курс лекцій">
    
    <link rel="preload" href="/docs/assets/css/0.styles.f5591410.css" as="style"><link rel="preload" href="/docs/assets/js/app.6573e971.js" as="script"><link rel="preload" href="/docs/assets/js/2.43c74522.js" as="script"><link rel="preload" href="/docs/assets/js/17.056e16ea.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.ae09fb39.js"><link rel="prefetch" href="/docs/assets/js/11.a892532e.js"><link rel="prefetch" href="/docs/assets/js/12.502d8f9b.js"><link rel="prefetch" href="/docs/assets/js/13.19ba463b.js"><link rel="prefetch" href="/docs/assets/js/14.b9bc508f.js"><link rel="prefetch" href="/docs/assets/js/15.8378044f.js"><link rel="prefetch" href="/docs/assets/js/16.c5ab21e3.js"><link rel="prefetch" href="/docs/assets/js/18.d77e96ca.js"><link rel="prefetch" href="/docs/assets/js/19.b664be5a.js"><link rel="prefetch" href="/docs/assets/js/20.d99a3a28.js"><link rel="prefetch" href="/docs/assets/js/21.19f4d8a1.js"><link rel="prefetch" href="/docs/assets/js/22.c12e4cd6.js"><link rel="prefetch" href="/docs/assets/js/23.cea9fca9.js"><link rel="prefetch" href="/docs/assets/js/24.03b428d0.js"><link rel="prefetch" href="/docs/assets/js/25.1189308b.js"><link rel="prefetch" href="/docs/assets/js/26.73a0e546.js"><link rel="prefetch" href="/docs/assets/js/27.94f39345.js"><link rel="prefetch" href="/docs/assets/js/28.a6b74891.js"><link rel="prefetch" href="/docs/assets/js/29.0d739a8d.js"><link rel="prefetch" href="/docs/assets/js/3.418ab320.js"><link rel="prefetch" href="/docs/assets/js/30.d3e49c4f.js"><link rel="prefetch" href="/docs/assets/js/31.5a79ea41.js"><link rel="prefetch" href="/docs/assets/js/32.892f4cee.js"><link rel="prefetch" href="/docs/assets/js/33.43c31432.js"><link rel="prefetch" href="/docs/assets/js/34.aa8b7542.js"><link rel="prefetch" href="/docs/assets/js/35.106db34a.js"><link rel="prefetch" href="/docs/assets/js/36.decaa943.js"><link rel="prefetch" href="/docs/assets/js/37.35adf566.js"><link rel="prefetch" href="/docs/assets/js/38.b395a8e9.js"><link rel="prefetch" href="/docs/assets/js/4.f33b38e3.js"><link rel="prefetch" href="/docs/assets/js/5.335a55c0.js"><link rel="prefetch" href="/docs/assets/js/6.98f769b8.js"><link rel="prefetch" href="/docs/assets/js/7.eaf79c7b.js"><link rel="prefetch" href="/docs/assets/js/8.721b5dad.js"><link rel="prefetch" href="/docs/assets/js/9.e42fd085.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.f5591410.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">Розподілені інформаційні системи</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link">
  Home
</a></div> <a href="https://github.com/boldak/dis-edu" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link">
  Home
</a></div> <a href="https://github.com/boldak/dis-edu" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/docs/intro/" class="sidebar-heading clickable"><span>Вступ</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/docs/arch/" class="sidebar-heading clickable"><span>Архітетура розподілених інформаційних систем</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/docs/components-interaction/" class="sidebar-heading clickable router-link-active open"><span>Реалізація взаємодії компонентів розподіленої інформаційної системи</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/components-interaction/01.express.html" aria-current="page" class="active sidebar-link">Розроблення веб-сервера за допомогою express.js</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/components-interaction/01.express.html#підготовлення-проекту" class="sidebar-link">Підготовлення проекту</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/components-interaction/01.express.html#фаилова-структура" class="sidebar-link">Файлова структура</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/01.express.html#встановлення-залежностеи" class="sidebar-link">Встановлення залежностей</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/01.express.html#конфігурування-сервера" class="sidebar-link">Конфігурування сервера</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/01.express.html#першии-запуск" class="sidebar-link">Перший запуск</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/01.express.html#налаштування-проміжного-пз-доступ-до-статичних-фаилів" class="sidebar-link">Налаштування проміжного ПЗ. Доступ до статичних файлів</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/01.express.html#оброблення-запитів" class="sidebar-link">Оброблення запитів</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/01.express.html#оброблення-параметрів-запиту" class="sidebar-link">Оброблення параметрів запиту</a></li></ul></li><li><a href="/docs/components-interaction/03.restfull-services.html" class="sidebar-link">RESTfull сервіси</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/components-interaction/03.restfull-services.html#підготовлення-проекту" class="sidebar-link">Підготовлення проекту</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/03.restfull-services.html#розроблення-контролера" class="sidebar-link">Розроблення контролера</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/03.restfull-services.html#розроблення-роутера" class="sidebar-link">Розроблення роутера</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/03.restfull-services.html#перевірка-працездатності-сервісу" class="sidebar-link">Перевірка працездатності сервісу</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/03.restfull-services.html#автоматизація-тестування-сервісу" class="sidebar-link">Автоматизація тестування сервісу</a></li></ul></li><li><a href="/docs/components-interaction/04.graphql.html" class="sidebar-link">GraphQL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/components-interaction/04.graphql.html#схема" class="sidebar-link">Схема</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/components-interaction/04.graphql.html#об-єктні-типи" class="sidebar-link">Об'єктні типи</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/04.graphql.html#скалярні-типи" class="sidebar-link">Скалярні типи.</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/04.graphql.html#інтерфеиси" class="sidebar-link">Інтерфейси</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/04.graphql.html#query-mutations-subscriptions" class="sidebar-link">Query, mutations, subscriptions</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/04.graphql.html#resolvers" class="sidebar-link">Resolvers</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/04.graphql.html#розроблення-graphql-сервісу" class="sidebar-link">Розроблення GraphQL сервісу</a></li></ul></li><li><a href="/docs/components-interaction/05.sse.html" class="sidebar-link">Push-нотифікація з використанням Server-Sent Events</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/components-interaction/05.sse.html#вимоги-до-push-сервера" class="sidebar-link">Вимоги до push-сервера</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/05.sse.html#використання-eventsource" class="sidebar-link">Використання EventSource</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/05.sse.html#розроблення-push-сервісу" class="sidebar-link">Розроблення push-сервісу</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/05.sse.html#першии-запуск" class="sidebar-link">Перший запуск</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/05.sse.html#вдосконалення-сервісу" class="sidebar-link">Вдосконалення сервісу</a></li></ul></li><li><a href="/docs/components-interaction/06.scripted-query.html" class="sidebar-link">Scripted Query сервіси</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/components-interaction/06.scripted-query.html#швидке-розроблення-програм-low-code-development-platform" class="sidebar-link">Швидке розроблення програм. Low-Code Development Platform</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/06.scripted-query.html#принцип-делегуванням-сценарію-оброблення-даних" class="sidebar-link">Принцип делегуванням сценарію оброблення даних</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/06.scripted-query.html#розроблення-сервісу-з-підтримкою-sq" class="sidebar-link">Розроблення сервісу з підтримкою SQ</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/06.scripted-query.html#обробник-sq-запитів-з-підтримкою-асинхроних-операціи" class="sidebar-link">Обробник SQ-запитів з підтримкою асинхроних операцій</a></li><li class="sidebar-sub-header"><a href="/docs/components-interaction/06.scripted-query.html#обробник-sq-запитів-з-підтримкою-sse" class="sidebar-link">Обробник SQ-запитів з підтримкою SSE</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/docs/swagger/" class="sidebar-heading clickable"><span>Прикладний програмний інтерфейс сервісів</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/docs/eda/" class="sidebar-heading clickable"><span>Реалізація взаємодії компонентів в EDA</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/docs/msa/" class="sidebar-heading clickable"><span>Реалізація взаємодії сервісів в MSA</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="розроблення-веб-сервера-за-допомогою-express-js"><a href="#розроблення-веб-сервера-за-допомогою-express-js" class="header-anchor">#</a> Розроблення веб-сервера за допомогою express.js</h1> <h2 id="підготовлення-проекту"><a href="#підготовлення-проекту" class="header-anchor">#</a> Підготовлення проекту</h2> <p>Для початку роботи необхідно встановити <a href="https://nodejs.org/uk/" target="_blank" rel="noopener noreferrer">Node.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Перевірити це встановлення за допомогою команд:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>node --version                                                                                 
v14.13.1                                                                                                                                 
                                                                                                                                         
<span class="token function">npm</span> --version                                                                                  
<span class="token number">6.14</span>.8          
</code></pre></div><p>На наступному кроці треба створити каталог проекту, перейти в нього та ініціювати проект за допомогою команди:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> init
</code></pre></div><h3 id="фаилова-структура"><a href="#фаилова-структура" class="header-anchor">#</a> Файлова структура</h3> <p>Після цього, створити наступну файлову структуру:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">.</span>
├───assets                                                                                                                               
├───models                                                                                                                               
├───routes

└── package.json             
</code></pre></div><p>Призначення каталогів:</p> <ul><li><strong>assets</strong> - статичні файли;</li> <li><strong>models</strong> - файли, що експортують моделі даних;</li> <li><strong>routes</strong> - файли, що експортують обробники запитів.</li></ul> <h3 id="встановлення-залежностеи"><a href="#встановлення-залежностеи" class="header-anchor">#</a> Встановлення залежностей</h3> <p>Встановіть необхідні для роботи пакети:</p> <div class="language- extra-class"><pre class="language-text"><code>npm install --save express body-parser cookie-parser

npm install --save-dev nodemon
</code></pre></div><p>Встановлені залежності будуть додані в файл <code>package.json</code>, який повинен мати наступний вигляд:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;express-getting-started&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ISC&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;body-parser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.19.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;cookie-parser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.4.5&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;express&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.17.1&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;nodemon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.0.9&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>В секцію <code>scripts</code> додамо скрипти для запуску сервера в <code>production</code> та <code>development</code> режимах</p> <div class="language-json extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;express-getting-started&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>
    <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node server&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nodemon server&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ISC&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;body-parser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.19.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;cookie-parser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.4.5&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;express&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.17.1&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;nodemon&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.0.9&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="конфігурування-сервера"><a href="#конфігурування-сервера" class="header-anchor">#</a> Конфігурування сервера</h2> <p>Необхідність модуля конфігурування обумовлена бажанням швидко переналаштовувати наш сервер. При цьому можна використовувати змінні середовища, доступ до яких здійснюється за допомогою об'єкту <code>process.env.&lt;env variable name&gt;</code>. Так, наприклад при розгортанні на хмарних платформах PAAS зазвичай здійснюється динамічне призначення порта (системна змінна <code>PORT</code>), на якому повинен бути запущений сервер. З іншого боку, при розробці сервера на локальному комп'ютері простіше зафіксувати конкретний порт ( в прикладі - 8080 ).</p> <p>Таким чином, якщо існує системна змінна <code>process.env.PORT</code>, тоді сервер запускаємо на цьому порту, інакше (режим розробки на локальному комп'ютері)  - на порту 8080.</p> <p>Створимо файл  <code>config.js</code> з наступним кодом:</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    server<span class="token operator">:</span><span class="token punctuation">{</span>
        port<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">8080</span><span class="token punctuation">,</span>
        staticPath<span class="token operator">:</span> <span class="token string">&quot;./assets&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="першии-запуск"><a href="#першии-запуск" class="header-anchor">#</a> Перший запуск</h2> <p>Створимо файл <code>server.js</code> з такими рядками:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./config&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>server<span class="token punctuation">.</span>port<span class="token punctuation">,</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">** EDU JACE server starts at port </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>config<span class="token punctuation">.</span>server<span class="token punctuation">.</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p>Ми імпортуємо встановлену за допомогою <code>npm</code> бібліотеку <a href="https://www.npmjs.com/package/express" target="_blank" rel="noopener noreferrer">express<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, а також наш файл конфігурації, створюємо примірник сервера та запускаємо його на відповідному до системного оточення порту. Після запуску сервера виводимо на консоль повідомлення про те, що сервер запущений.</p> <p>Запустимо сервер за допомогою команди  <code>npm run dev</code> та отримаємо в консолі наступний текст:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run dev                                                                                    
                                                                                                                                         
<span class="token operator">&gt;</span> express-getting-started@1.0.0 dev D:<span class="token punctuation">\</span>docs<span class="token punctuation">\</span>EDU<span class="token punctuation">\</span><span class="token number">2021</span><span class="token punctuation">\</span>dist-inf-sys<span class="token punctuation">\</span>src<span class="token punctuation">\</span>express                                                            
<span class="token operator">&gt;</span> nodemon server                                                                                                                         
                                                                                                                                         
<span class="token punctuation">[</span>nodemon<span class="token punctuation">]</span> <span class="token number">2.0</span>.9                                                                                                                          
<span class="token punctuation">[</span>nodemon<span class="token punctuation">]</span> to restart at any time, enter <span class="token variable"><span class="token variable">`</span>rs<span class="token variable">`</span></span>                                                                                             
<span class="token punctuation">[</span>nodemon<span class="token punctuation">]</span> watching path<span class="token punctuation">(</span>s<span class="token punctuation">)</span>: *.*                                                                                                          
<span class="token punctuation">[</span>nodemon<span class="token punctuation">]</span> watching extensions: js,mjs,json                                                                                               
<span class="token punctuation">[</span>nodemon<span class="token punctuation">]</span> starting <span class="token variable"><span class="token variable">`</span>node server.js<span class="token variable">`</span></span>                                                                                                      
** EDU JACE server starts at port <span class="token number">8080</span>      
</code></pre></div><p>Бачимо, що при запуску <code>npm run dev</code>  активується виклик <code>nodemon server</code> та наш сервер запускається на порту 8080 в оточенні  <code>nodemon</code>, який забезпепує &quot;гаряче перезавантаження&quot; (тобто ми працюємо на локальному комп'ютері).</p> <p>Тепер в браузері робимо запит за адресою <a href="http://localhost:8080">http://localhost:8080</a>, та маємо наступну відповідь від сервера:</p> <center><img src="/1.jpg" style="border-radius:4px;border:1px solid #cfd7e6;box-shadow:0 1px 3px 0 rgba(89,105,129,.05), 0 1px 1px 0 rgba(0,0,0,.025);"></center> <p>Наш сервер - запущений, але не обробляє запитів (принаймні типу <code>GET</code>).</p> <h2 id="налаштування-проміжного-пз-доступ-до-статичних-фаилів"><a href="#налаштування-проміжного-пз-доступ-до-статичних-фаилів" class="header-anchor">#</a> Налаштування проміжного ПЗ. Доступ до статичних файлів</h2> <p>Express, по суті, являє собою серію викликів функцій проміжної обробки.</p> <p>Функції проміжної обробки (middleware) - це функції, які мають доступ до об'єкту запиту <code>request</code>, об'єкту відповіді <code>response</code> і наступної функції проміжної обробки <code>next</code> в циклі оброблення запиту.
Функції проміжної обробки можуть виконувати такі завдання:</p> <ul><li>Виконання будь-якого коду.</li> <li>Внесення змін до об'єкти запитів і відповідей.</li> <li>Завершення циклу &quot;запит-відповідь&quot;.</li> <li>Виклик наступної функції тимчасової роботи з стека.</li></ul> <p>Якщо поточна функція проміжної обробки завершує цикл &quot;запит-відповідь&quot;, вона повинна викликати <code>next()</code> для передачі управління наступної функції проміжної обробки. В іншому випадку запит зависне.</p> <center style="border-radius:4px;border:1px solid #cfd7e6;box-shadow:0 1px 3px 0 rgba(89,105,129,.05), 0 1px 1px 0 rgba(0,0,0,.025);padding:1em;"><img src="https://www.plantuml.com/plantuml/svg/ZP712iCW44JlViKU4uX2zLPA2VHB9Ev1I8nLG_lvNKa8IJ0bDvtPcGUxRKmwf6de6UWkZG5UlKMN67YIRMUzTWcqztjXiCRq-D41RsU6F3CK0xPGW3zpznq2lYUCHALV5ZVzgzdG8_hHHMp0uPU6DrE7q5pqu7pVb6DLNQ38InHv29KeyWz5NQAeGcYU5H6TgOGGTOcirgrcVLdh76Gj1Ud6Fm00" alt="uml diagram"></center> <p>Однією з вбудованих функцій проміжної обробки є функція оброблення запитів до статичного контенту <code>express.static</code>, яка дозволяє налаштувати доступ до статичних файлів.</p> <p>Вдосконалимо наш сервер:</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./config&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>server<span class="token punctuation">.</span>staticPath<span class="token punctuation">)</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>server<span class="token punctuation">.</span>port<span class="token punctuation">,</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">** EDU JACE server starts at port </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>config<span class="token punctuation">.</span>server<span class="token punctuation">.</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><p>Для <code>express.static</code> необхідно вказати шлях до статичних файлів. В даному випадку, цей шлях записаний в <code>config.server.staticPath</code> (значення <code>&quot;./assets&quot;</code>)</p> <p>В каталозі <code>./assets</code> створимо файл <code>index.html</code>:</p> <div class="language-html extra-class"><pre class="language-html"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span> EDU JACE server <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span> 
</code></pre></div><p>Перезавантажимо сторінку за адресою <a href="http://localhost:8080">http://localhost:8080</a>. Побачимо відповідь сервера:</p> <center><img src="/2.jpg" style="border-radius:4px;border:1px solid #cfd7e6;box-shadow:0 1px 3px 0 rgba(89,105,129,.05), 0 1px 1px 0 rgba(0,0,0,.025);"></center> <h2 id="оброблення-запитів"><a href="#оброблення-запитів" class="header-anchor">#</a> Оброблення запитів</h2> <p>Маршрутизація визначає, як сервер відповідає на клієнтський запит до конкретної адреси (end point), яким є URI (або шлях), і певного методу запиту HTTP (GET, POST і т.п.).</p> <p>Кожен маршрут може мати одну або кілька функцій обробки, які виконуються при зіставленні маршруту.</p> <p>Express підтримує перераховані методи маршрутизації, які відповідають методам HTTP: <code>get, post, put, head, delete, options, trace, copy, lock, mkcol, move, purge, propfind, proppatch, unlock, report, mkactivity, checkout, merge, m-search, notify, subscribe, unsubscribe, patch, search, connect</code>. Існує особливий метод маршрутизації, <code>app.all()</code>, який не є похідним від будь-якого методу HTTP. Цей метод використовується для активації middleware для всіх методів запиту.</p> <p>Шляхи маршрутів можуть рядками, шаблонами рядків або регулярними виразами:</p> <ul><li><code>/</code> - рядок, що позначає кореневий маршрут;</li> <li><code>/about</code> - рядок, що позначає маршрут <code>/about</code> (наприклад, <a href="http://localhost:8080/about" target="_blank" rel="noopener noreferrer">http://localhost:8080/about<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>);</li> <li><code>/ab?cd</code> - шаблон рядка, в якому є необов'язкове включення <code>b</code> (<code>acd</code>,<code>abcd</code>);</li> <li><code>/ab+cd</code> - шаблон рядка, в якому є одне або декілька включень <code>b</code> (<code>abcd</code>,<code>abbcd</code>,<code>abbbcd</code>, ...);</li> <li><code>/ab*cd</code> - шаблон рядка, в якому є будь-яка комбінація символів після <code>b</code> (<code>abcd</code>,<code>abxcd</code>,<code>ab123cd</code>, ...);</li> <li><code>/a/</code> - регулярний вираз, який відповідає рядку з літерою <code>a</code>;</li> <li><code>/.*fly$/</code> - регулярний вираз, який відповідає рядку, якій закінчується на <code>fly</code>.</li></ul> <p>Об'єкт <code>Router</code> являє собою ізольований екземпляр проміжного програмного забезпечення і маршрутів. Ви можете сприймати це як “міні-застосунок”, здатний виконувати лише проміжне програмне забезпечення та функції маршрутизації. Кожна програма Express має вбудований маршрутизатор додатків. Ви можете використовувати його як аргумент для <code>app.use()</code> або як аргумент методу <code>use()</code> іншого маршрутизатора.</p> <p>Об’єкт верхнього рівня express має метод <code>Router()</code>, який створює новий <code>router</code> об’єкт.</p> <p>Після того як ви створили об'єкт маршрутизатора, ви можете додати проміжний шар і HTTP метод маршрутів (наприклад get, put, post, і так далі) до нього.</p> <p>Уявімо, що наш сервер буде надавати доступ до даних про президентів Сполучених Штатів.</p> <p>По-перше, змоделюємо сховище даних. Для цього в каталозі <code>./models</code> створимо файл <code>presidents.js</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">&quot;Barrac Obama&quot;</span><span class="token punctuation">,</span>
        photo<span class="token operator">:</span> <span class="token string">&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/President_Barack_Obama.jpg/274px-President_Barack_Obama.jpg&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">&quot;Donald Trump&quot;</span><span class="token punctuation">,</span>
        photo<span class="token operator">:</span> <span class="token string">&quot;https://upload.wikimedia.org/wikipedia/commons/5/56/Donald_Trump_official_portrait.jpg&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        id<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">&quot;Joe Biden&quot;</span><span class="token punctuation">,</span>
        photo<span class="token operator">:</span> <span class="token string">&quot;https://upload.wikimedia.org/wikipedia/commons/6/68/Joe_Biden_presidential_portrait.jpg&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><p>По-друге, в каталозі <code>./routes</code> створимо файл <code>index.js</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> Presidents <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../models/presidents&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> <span class="token function-variable function">getPresidents</span> <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token parameter">request<span class="token punctuation">,</span> response</span> <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    response<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>Presidents<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

router
    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/presidents&quot;</span><span class="token punctuation">,</span> getPresidents<span class="token punctuation">)</span>


module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router 
</code></pre></div><p>Створюємо примірник маршрутизатора (<code>router</code>), імпортуємо нашу модель (<code>Presidents</code>), визначаємо функцію оброблення запиту (<code>getPresidents</code>), задаємо для <code>router</code> обробник, який відповідає шляху <code>/presidents</code> та експортуємо <code>router</code>.</p> <p>Останнє, в файлі <code>serer.js</code>підключаємо <code>router</code> та налаштовуємо маршрутизатор:</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./config&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./routes&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>server<span class="token punctuation">.</span>staticPath<span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;/api&quot;</span><span class="token punctuation">,</span> router<span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>server<span class="token punctuation">.</span>port<span class="token punctuation">,</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">** EDU JACE server starts at port </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>config<span class="token punctuation">.</span>server<span class="token punctuation">.</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>Таким чином, наш сервер має обробник запитів за шляхом <a href="http://localhost:8080/api/presidents" target="_blank" rel="noopener noreferrer">http://localhost:8080/api/presidents<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. В браузері звернемося за цією адресою і отримаємо відповідь:</p> <center><img src="/3.jpg" style="border-radius:4px;border:1px solid #cfd7e6;box-shadow:0 1px 3px 0 rgba(89,105,129,.05), 0 1px 1px 0 rgba(0,0,0,.025);"></center> <h2 id="оброблення-параметрів-запиту"><a href="#оброблення-параметрів-запиту" class="header-anchor">#</a> Оброблення параметрів запиту</h2> <p>Додаткові параметри запиту можна передавати декількома способами:</p> <ul><li>за допомогою частини шляху;</li> <li>за допомогою <code>queryString</code>;</li> <li>за допомогою <code>body</code>;</li> <li>за допомогою  <code>cookie</code>.</li></ul> <p>Якщо в якості шляху використовувати спеціальний шаблон з параметрами <code>/prePath/:param1/:param2/postPath</code>, тоді доступ до параметрів запиту (<code>param1</code>, <code>param2</code>) може здійснюватися за допомогою <code>query.params</code>.</p> <p><code>QueryString</code> є частиною уніфікованого покажчика ресурсу (URL) , який присвоює значення зазначених параметрів. Рядок запиту зазвичай включає поля, додані до базової URL-адреси веб-браузером або іншим клієнтським додатком.
Типова URL-адреса, що містить <code>queryString</code>, така: <a href="https://example.com/over/there?name=ferret" target="_blank" rel="noopener noreferrer">https://example.com/over/there?name=ferret<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. В цьому випадку, шлях - це <code>/over/there</code>, а  <code>queryString</code> - <code>name=ferret</code>. Знак питання використовується як роздільник і не є частиною <code>query</code>. Доступ до параметрів, які передані через <code>queryString</code> здійснюється за допомогою <code>response.query</code></p> <p>В запитах <code>POST</code>,<code>PUT</code> та інших (окрім <code>GET</code>) можна використати тіло запиту (<code>body</code>) для передачі додаткових атрибутів. Коли ви передаєте атрибути в <code>body</code>, ви передаєте атрибути як частину об'єкта, описаного як <code>json</code>.
Для зручності оброблення <code>body</code> використовують спеціальне middleware <a href="https://www.npmjs.com/package/body-parser" target="_blank" rel="noopener noreferrer">body-parser<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, яке аналізує <code>body</code> у проміжному програмному забезпеченні перед вашими обробниками, доступними в <code>req.body</code>. Цей модуль забезпечує наступні аналізатори:</p> <ul><li>Парсер тіла JSON</li> <li>Аналізатор сирого тіла</li> <li>Синтаксичний розбір тексту тексту</li> <li>Синтаксичний аналізатор форми, кодований URL-адресою</li></ul> <p><code>bodyParser</code> надає різні способи створення проміжного програмного забезпечення. Усі проміжні засоби заповнюватимуть <code>req.body</code>, коли заголовок запиту <code>Content-Type</code> відповідає <code>type</code> параметру, або порожнім об’єктом ( {}), якщо <code>Content-Type</code> не було зіставлено або сталася помилка. Наприклад, <code>bodyParser.json</code> повертає проміжне програмне забезпечення, яке лише аналізує <code>json</code> і переглядає запити лише там, де <code>Content-Type</code>відповідає цій опції (<code>application/json</code>). Цей аналізатор приймає будь-яке кодування Unicode тіла та підтримує автоматичне розгортання gzip та deflate кодування.</p> <p><code>HTTP-cookie</code> - у комп'ютерній термінології поняття, яке використовується для опису інформації у вигляді текстових або бінарних даних, отриманих від веб-сайту на веб-сервері, яка зберігається у клієнта, тобто браузера, а потім відправлена на той самий сайт, якщо його буде повторно відвідано. Таким чином веб-сервер помічає браузер користувача при відвідуванні. Кукі створюються за ініціативою скриптового сценарію на стороні веб-браузера. При наступному візиті сервер буде знати, що користувач вже тут був. За допомогою кукі-технології можна вивчити вподобання відвідувача. Кукі є одним із найточніших засобів визначення унікального користувача. Для зручності оброблення <code>cookies</code> використовують спеціальне middleware <a href="https://www.npmjs.com/package/cookie-parser" target="_blank" rel="noopener noreferrer">cookie-parser<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, яке аналізує Cookie заголовок та заповнює <code>req.cookies</code> об’єктом, який закріплений за іменами файлів cookie.</p> <p>Для перевірки способів передачі параметрів в запитах, доповнемо файл <code>./routes/index.js</code>:</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> Presidents <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../models/presidents&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> <span class="token function-variable function">getPresidents</span> <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token parameter">request<span class="token punctuation">,</span> response</span> <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    response<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>Presidents<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> <span class="token function-variable function">echoRequest</span> <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token parameter">request<span class="token punctuation">,</span> response</span> <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    response<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        query<span class="token operator">:</span> request<span class="token punctuation">.</span>query<span class="token punctuation">,</span>
        body<span class="token operator">:</span> request<span class="token punctuation">.</span>body<span class="token punctuation">,</span>
        params<span class="token operator">:</span> request<span class="token punctuation">.</span>params<span class="token punctuation">,</span>
        cookies<span class="token operator">:</span> request<span class="token punctuation">.</span>cookies
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> 

router
    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/presidents&quot;</span><span class="token punctuation">,</span> getPresidents<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/echo/:param&quot;</span><span class="token punctuation">,</span> echoRequest<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/echo/:param&quot;</span><span class="token punctuation">,</span> echoRequest<span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router 
</code></pre></div><p>Визначаємо новий обробник запитів <code>echoRequest</code>, який у відповіді повертає параметри, передані в запиті. Потім назначаємо цей обробник на запити <code>GET</code> та <code>POST</code> за шляхом <code>/echo/:param</code> (<code>param</code> - параметр запиту, як частина шляху).</p> <p>Налагодим необхідне middleware в файлі <code>server.js</code>:</p> <div class="language-js extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cookieParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cookie-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./config&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./routes&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>server<span class="token punctuation">.</span>staticPath<span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cookieParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    limit<span class="token operator">:</span> <span class="token string">'50mb'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;/api&quot;</span><span class="token punctuation">,</span> router<span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>server<span class="token punctuation">.</span>port<span class="token punctuation">,</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">** EDU JACE server starts at port </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>config<span class="token punctuation">.</span>server<span class="token punctuation">.</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>


</code></pre></div><p>В браузері здійснимо запит за адресою <a href="http://localhost:8080/api/echo/1?name=Barrac&amp;isCurrent=true" target="_blank" rel="noopener noreferrer">http://localhost:8080/api/echo/1?name=Barrac&amp;isCurrent=true<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <center><img src="/4.jpg" style="border-radius:4px;border:1px solid #cfd7e6;box-shadow:0 1px 3px 0 rgba(89,105,129,.05), 0 1px 1px 0 rgba(0,0,0,.025);"></center> <p>Як бачимо, <code>body</code> - це пустий об'єкт, тому що в запитах <code>GET</code> <code>body</code> не підтримується.</p> <p>Для реалізації запиту <code>POST</code> скористаємося розширенням <a href="https://chrome.google.com/webstore/detail/tabbed-postman-rest-clien/coohjcphdfgbiolnekdpbcijmhambjff" target="_blank" rel="noopener noreferrer">Tabbed Postman - REST Client<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> для браузера Chrome:</p> <center><img src="/5.jpg" style="border-radius:4px;border:1px solid #cfd7e6;box-shadow:0 1px 3px 0 rgba(89,105,129,.05), 0 1px 1px 0 rgba(0,0,0,.025);"></center></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/boldak/dis-edu/edit/master/docs/components-interaction/01.express.md" target="_blank" rel="noopener noreferrer">Ви можете покращити цю сторінку</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/25/2021, 11:36:11 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/arch/11.arch.html" class="prev">
        Архітектурні принципи проектування розподілених інформаційних систем
      </a></span> <span class="next"><a href="/docs/components-interaction/03.restfull-services.html">
        RESTfull сервіси
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/docs/assets/js/app.6573e971.js" defer></script><script src="/docs/assets/js/2.43c74522.js" defer></script><script src="/docs/assets/js/17.056e16ea.js" defer></script>
  </body>
</html>
